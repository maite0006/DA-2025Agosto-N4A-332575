<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Menú Administrador</title>
    <link rel="stylesheet" href="css/menuAdministrador.css">
    <script src="vistaWeb.js"></script>
</head>
<body>
    <div class="sidebar">
        <label>Administrador: </label>
        <div id="NombreAdm"></div>
        <button onclick="cargarVista('AltaTransito.html')">Alta tránsito</button>
        <button onclick="cargarVista('AltaBonificacionU.html')">Asignar bonificación</button>
        <button onclick="cargarVista('CambioEstadoU.html')">Cambiar estado</button>
        <button onclick="Logout()">Salir</button>
    </div>

    <div class="content">
        <iframe id="iframeContenido" src="altaTransito.html"></iframe>
    </div>

    <script>
        urlIniciarVista="/menuAdm/vistaConectada";
	    urlRegistroSSE = "/menuAdm/registrarSSE"; 

        // Redirige el iframe al contenido elegido
        function cargarVista(vista) {
            document.getElementById("iframeContenido").src = vista;
        }

        // Logout del admin
        function Logout() {
            submit('/accesoAdministrador/logout', '', 'POST');
        }

        function mostrar_logoutExitoso(urlDestino) {
            window.location.href = urlDestino;
        }

        function mostrar_NombreAdmin(nombre){
            document.getElementById("NombreAdm").innerHTML=nombre;
        }
        function mostrar_usuarioNoAutenticado(urlDestino) {
            window.location.href = urlDestino;
        }
        const evtSource = new EventSource(urlRegistroSSE);
        evtSource.onmessage = function(event) {
            const listaRespuestas = JSON.parse(event.data); 
            procesarResultadosSubmit(listaRespuestas); 
        };
        function conexionSSECerrada(event){
                cerrar();
        }
        async function cerrar(){
            let respuesta = await mostrarConfirmacion("Se ha cerrado la aplicacion en esta ventana", "Intenar volver a abrirla", "Cerrar");
            if (respuesta) {
                location.reload();
            } else {
                document.body.innerHTML = '';
            }
        }
    </script>
</body>
</html>
